<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>BikeFinder</title>
    <link rel=stylesheet type="text/css" href="bikefinder.css">
    <link rel="icon" href="icon.png"><!-- put icon in tab bar in browser -->
    
    <script>
        var myCentre;
        // function to find location of user
        function findLocation() {
            if (!navigator.geolocation) { // if location can't be found
                myCentre = new google.maps.LatLng(53.344007,-6.266802); //default location
                return;
            }
            function found(position) {
                myCentre = new google.maps.LatLng(position.coords.latitude,
                                                 position.coords.longitude);
            }
            navigator.geolocation.getCurrentPosition(found);
        }
        
        findLocation();
        
        function initialise(x) {
//            findLocation();
            // map properties
            var mapProps = {
                center: myCentre,
                zoom: 16,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById("googleMap"),mapProps);
            
            // user's current selection of functionality
            var current = document.getElementById("current");
            if(x==1) { // bikes near me
                var marker = new google.maps.Marker({
                    position: myCentre,
                    icon: "green.png"
                });
                marker.setMap(map);
                if (!current.innerHTML.match("Bikes Near Me")) {
                    if (current.innerHTML.match("Spaces Near Me")) {
                        current.id="spaces";
                    } else if (current.innerHTML.match("Search By Station Address")) {
                        current.id="address";;
                    } else {
                        current.removeAttribute("id");
                    }
                    document.getElementById("bikes").id="current";
                }
            } else if (x==2) { // spaces near me
                var marker = new google.maps.Marker({
                    position: myCentre,
                    icon: "finishgreen.png"
                });
                marker.setMap(map);
                if (!current.innerHTML.match("Spaces Near Me")) {
                    if (current.innerHTML.match("Bikes Near Me")) {
                        current.id="bikes";
                    } else if (current.innerHTML.match("Search By Station Address")) {
                        current.id="address";
                    } else {
                        current.removeAttribute("id");
                    }
                    document.getElementById("spaces").id="current";
                }
            } else if (x==3) { // search by address
                var marker = new google.maps.Marker({
                    position: myCentre,
                    icon: "finishred.png" // temporary holder
                });
                marker.setMap(map);
                if (!current.innerHTML.match("Search By Station Address")) {
                    if (current.innerHTML.match("Spaces Near Me")) {
                        current.id="spaces";
                    } else if (current.innerHTML.match("Bikes Near Me")) {
                        current.id="bikes";
                    } else {
                        current.removeAttribute("id");
                    }
                    document.getElementById("address").id="current";
                }
            }
            console.log(current.innerHTML); // debugging buttons - problem with "current" id
        }

        function loadScript() {
            var script = document.createElement("script");
            script.type = "text/javascript";
            script.src = "http://maps.googleapis.com/maps/api/js?key=&sensor=false&callback=initialise";
            document.body.appendChild(script);
        }

        window.onload = loadScript;
    </script>
</head>




<header>
    <div>
        <img src="Dublin_Bikes_logo.jpg" alt="Dublin Bikes Logo" />
    </div>
    <h1>BikeFinder <span>Dublin</span></h1>
</header>
    
<body>
<div id="container">
    <nav><!-- navigation bar -->
        <ul>
            <!-- change to other maps -->
            <li id="bikes" onclick="initialise(1)">Bikes Near Me</li>
            <li id="spaces" onclick="initialise(2)">Spaces Near Me</li>
            <li id="address" onclick="initialise(3)">Search By Station Address</li>
        </ul>
    </nav>
    <div id="googleMap"></div>
</div>
    
<p id="current"></p> <!-- holder for current ID -->
    
<footer>
    <p>Copyright 2016 Stephen Murphy, Kevin Fitzpatrick, Keith Kennedy. All Rights Reserved.</p>
</footer>
</body>
</html>